import requests
from requests.exceptions import Timeout
import psutil
import sys
import time
import subprocess

proxies = {'http':'http://127.0.0.1:8080','https':'https://127.0.0.1:8080'}
timeout = 5
headers = {'Content-Type':'application/x-www-form-urlencoded'}


def http_request(url,method='None',data=None,headers=None,proxies=None,timeout=None):
     
    try:
        # POST Method        
        if method.lower() == 'post':
            res = requests.post(url,data,headers=headers,proxies=proxies,timeout=timeout)
        
        # Default GET Method
        else:
            res = requests.get(url,headers=headers,proxies=proxies,timeout=timeout)
        return res
        
    except Exception as error:
        return error


def startWebServer(port):
    print("[+] starting webserver")
    webserver = subprocess.Popen('/usr/bin/python3 -m http.server %s' % port, shell=True)
    return webserver

def stopWebServer(webserver):
    print("\t [-] stopping webserver")
    parent = psutil.Process(webserver.pid)
    for proc in parent.children(recursive=True):
        proc.kill()
    parent.kill()
    return

def startNetcatListener(port):
    print("\t [-] Starting netcat listener")
    proc = subprocess.Popen('./nc -lvp %s' % port, shell=True)
    return proc

if __name__ == "__main__":
    print ("\033[1m--- %s  Proof of Concept Exploit ---\033[0m\n" % "CHANGE ME")
    # if  len(sys.argv) != 4:
    #     print("\033[31;1m[!]\033[022m Usage: %s target_ip attacker_ip port_number\033[0m" % sys.argv[0])
    #     exit()
    # target = sys.argv[1]
    # attacker = sys.argv[2]
    # port = sys.argv[3]

    target = '192.168.0.100'
    attacker = '192.168.1.5'
    port = '9001'
    
    # global baseurl
    # baseurl = "http://%s" % target

    # Exploit Steps
    #     
    #1. STEP 1
    
    
    #2. STEP 2
    
    
    #3. STEP 3
          
    exit()

