# function to check payloads for bad characters
# Add as a check to exploit code

import sys

def check_bad_chars(badchars, buffer):
	badchars_hex = [f'{char:02x}' for char in badchars]
	print('[!] Checking payload for bad characters:')
	print('\t[!] '+ str(badchars_hex))
	buffer_hex = [f'{char:02x}' for char in buffer]
	for index, b in enumerate(buffer_hex):
		print('%s : %s' % (index,b))
		if b in (badchars_hex):
			print('[!] Bad character: %s detected at position %s in buffer' % (b,index))
			exit()
	return False

# example usage
badchars = b'\x00\x0a\x0b\x0c\x20'
buffer = b'42' * 20
buffer += b'\x0a'
check_bad_chars(badchars, buffer)
